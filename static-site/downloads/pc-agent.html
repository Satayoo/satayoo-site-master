<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Download PC Agent — Satayoo</title>
  <meta name="robots" content="noindex">
  <style>
    body{font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:40px;color:#1a1a1a}
    .box{max-width:720px;margin:0 auto}
    a.btn{display:inline-block;margin-top:10px;padding:10px 14px;border-radius:10px;border:1px solid #2a2f3a;background:#151823;color:#eaeaf2;text-decoration:none}
    .muted{color:#667}
    code{background:#f6f7f9;padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
<div class="box">
  <h1>Windows PC Agent</h1>
  <p class="muted" id="status">Fetching the latest release… If the download doesn’t start, use the direct link below.</p>
  <p><a id="direct" class="btn" href="#" download>Direct download</a></p>
  <p class="muted">If you see a 404, it means no release is published yet. In that case, download will be available after we publish the first release.</p>
</div>
<script>
function triggerDownload(url){
  try{
    // Prefer an anchor click with download attribute (works in most browsers)
    const a = document.createElement('a');
    a.href = url;
    a.download = 'pc-agent.exe';
    a.rel = 'noopener';
    a.style.display = 'none';
    document.body.appendChild(a);
    a.click();
    setTimeout(()=>a.remove(), 250);
    // Fallback navigation if the browser blocks programmatic click
    setTimeout(()=>{ if (!document.hidden) window.location.assign(url); }, 800);
  }catch(_){
    // Last resort
    window.location.assign(url);
  }
}

(async()=>{
  const statusEl = document.getElementById('status');
  const direct = document.getElementById('direct');
  try{
    // Option B: pull from repo raw URL (requires the .exe to be committed)
    const rawUrl = 'https://raw.githubusercontent.com/Satayoo/satayoo-pc-agent/main/pc-agent.exe';
    // Probe the file to ensure it exists (HEAD)
    const head = await fetch(rawUrl, { method: 'HEAD' });
    if(!head.ok){ throw new Error('Raw .exe not found in repo'); }
    direct.href = rawUrl;
    direct.setAttribute('download', 'pc-agent.exe');
    direct.addEventListener('click', (e)=>{ e.preventDefault(); triggerDownload(rawUrl); });
    statusEl.textContent = 'Starting download…';
    triggerDownload(rawUrl);
  }catch(e){
    statusEl.textContent = 'PC Agent not available yet. Please check back soon.';
    direct.classList.add('disabled');
    direct.addEventListener('click', (ev)=>{ ev.preventDefault(); });
  }
})();
</script>
</body>
</html>

